#应用层

##应用层协议原理
###网络应用程序体系结构
- 客户机/服务器体系结构和对等（P2P）体系结构
###进程通信
- 计算机体系中，负责通信的实际上时进程，不同端系统上的进程通过跨越计算机网络交换报文而相互通信。
- 网络应用程序是由成对的进程组成，这些进程通过网络相互发送报文，对没对通信进程，通常将两个进程分别标识为客户机/服务器
- 在给定的一对进程的通信会话中，发起通信的进程被标识为客户机，在会话开始时等待响应的进程服务器
- 进程通过一个称为套接字的软件接口在网络上发送和接收报文
- 套接字又称为应用程序和网络之间的应用程序编程接口，是应用程序进程和运输层协议之间的接口
- 引用层能为应用程序提供四方面服务：可靠数据传输、吞吐量、定时、安全性
###因特网提供的运输服务
- 因特网上的应用使用了两个运输层协议（UDP和TCP）
- TCP服务：包括面向连接服务和可靠数据传输服务：面向连接（通过握手创建TCP连接，双向，使用完毕需要拆除连接）；可靠数据传输服务（无差错，按适当顺序交付发送的数据）；拥塞控制机制
- 由于TCP和UDP没有提供任何加密机制，产生了TCP加强版：安全套接字层（SSL）
- UDP服务：UDP是一种不提供不必要服务的轻量级运输层协议，是无连接的和不可靠数据传输服务
- 应用层协议：电子邮件（SMTP）、远程终端访问(Telent)、web(HTTP)、文件传输(FTP)、流媒体(HTTP或RTP)一般使用TCP，因特网电话（SIR、RTR）一般使用UDP
- 进程寻址P60:通过IP标识主机，通过端口号标识目的主机上接收进程
###应用层协议
- 应用层协议定义了运行在不同端系统上的应用程序进程如何相互传递报文，定义了：交换的报文类型、各种报文类型的语法、字段的语义、进程何时 如何发送报文以及对报文的响应规则。
##web应用和http协议
###http概况
- web的应用层协议是超文本传输协议（HTTP），是web的核心。http协议由两部分程序实现：一个客户机程序和一个服务器程序，他们运行在不同的端系统中，通过交换HTTP报文进行会话。
- 基本术语：web页面是由对象组成；对象简单说就是文件，html文件，图片文件等都是对象；
- 每个url地址由两部分组成：存放对象的服务器主机名和对象的路径名
- HTTP定义了web客户机是如何向web服务器请求web页面，以及服务器如何将web页面传送给客户机的。http使用TCP作为他的支撑运输层协议。
- 无状态：服务器向客户机发送被请求的文件时，并不存储任何关于该客户机的状态信息，加入某个客户机短时间内联系请求服务器，服务器会每次都会发送对象给客户机，不会因为刚发过而做出任何其他反应。
###非持久连接和持久连接 p63 2018年5月17日 12:44:04
- 当客户机和服务器的交互运行与TCP协议之上时，应用程序的研制者需要确定每个请求/响应对是经过一个单独的TCP连接发送，还是所有请求及相应的响应经相同的TCP连接发送，前一种方法成为非持久性连接，后一种方法成为持久性连接。
- 默认情况下HTTP是持久性连接
- 往返时间（RTT）：一个小的分组从客户机到服务器再回到客户机所花费的时间，包括分组传播时延、分组在中间路由器和交换机上的排队时延以及分组处理时延。
- 三次握手：首先客户机向服务器发送一个小的TCP报文段，服务器用一个小的TCP报文段做出确认和响应，最后，客户机向服务器发送确认，并且包含请求报文作为第三次握手。
- 非持久连接的缺点：必须为每一个请求对象建立和维护一个全新的连接。每个对象的传输时延为两个RTT，一个RTT用于建立TCP连接，另个RTT用于请求和接收对象。
###HTTP报文格式
- 分为请求报文和响应报文
- HTTP请求报文的第一行叫做请求行，其后继的行叫做首部行。请求行有3个字段：方法字段、URL字段和HTTP协议字段。
- Host定义了目标所在的主机；User-agent首部行用来定义用户代理，即向服务器发送请求的浏览器类型；Accept-language:首部行表示用户想得到该对象的语法版本，否则使用服务器的默认版本。
- HTTP响应报文分为三部分：状态行、首部行、实体主体
###用户和服务器的交互：cookie
- cookie技术有4个组成部分：1.在HTTP响应报文中有一个cookie首部行；2.在HTTP请求报文中有一个cookie首部行；3.在用户端系统中保留有一个cookie文件，由用户的浏览器管理；4.在web站点有一个后端数据库。
###web缓存
 - web缓存器也叫代理服务器，他是能够代表初始web服务器来满足HTTP请求的网络实体，web缓存器有自己的磁盘存储空间，并在该存储空间中保存最近请求过得对象的拷贝。
 - 因为web缓存器的原因：1.web缓存器可以大大减少对客户机请求的响应时间，特别是当客户机与初始服务器之间的瓶颈带宽远远低于客户机与web缓存器之间的带宽瓶颈时更是如此；2.web缓存器可以大大减少一个机构内部网和
 因特网接入链路上的通信量，从而降低带宽，降低成本。
 ###条件GET方法 P72
 - 如果请求报文使用GET方法，并且包含If_modified-since首部，那么这个http请求报文就是一个条件GET请求
 ##文件传输服务器FTP
 - FTP和HTTP都是文件传输协议，最主要的区别是FTP使用两个并行的TCP连接来传输文件，一个是控制连接，一个是数据连接。控制连接用于在两个主机之间传输控制信息，如用户口令，标识，改变远程目录的命令以及put和get文件的命令，
 数据连接用于实际传输一个文件。因为FTP协议使用一个分离的控制连接，所以我们也称FTP控制是带外传送的。HTTP协议是在传输文件的TCP连接中发送请求和响应首部行的，因此HTTP可以说是带内的。
 - 对FTP传输而言，控制连接贯穿了整个用户用户会话期间，但是针对会话中每一次文件传输都需要建立一个新的数据连接。
##因特网中的电子邮件
- 用户代理，邮件服务器，简单邮件传输协议（SMTP）
###SMTP
- SMTP用于从发送方的邮件服务器发送报文到接受方的邮件服务器
###与HTTP对比
1.HTTP是拉协议：TCP连接由想要获取文件的机器发起；SMTP是推协议：TCP连接是由要发送文件的机器发起的；2.SMTP要求每个报文都使用7为的ASC11码格式；3.HTTP把每个对象封装到他自己的HTTP响应报文中，而因特网电子邮件则把所有报文对象放在一个报文中。
###邮件报文格式和MIME 2018年5月19日 08:33:41 P81
###邮件访问协议
##DNS：因特网的目录服务
- DNS是应用层协议
- 域名系统（DNS）：是一个由分层的DNS服务器实现的分布式数据库；是一个允许主机查询分布式数据库的应用层协议。
- DNS服务器通常是运行BIND软件的UNIX机器。DNS协议运行在UDP之上，端口是53
- DNS通常由其他应用层协议（HTTP/SMTP/FTP）所使用，用于将用户提供的主机名解析为IP地址。
###DNS工作机理概述
- DNS服务器采用分布式、层次数据库：有三种类型的DNS服务器：根DNS服务器、顶级域（TLD）DNS服务器、权威DNS服务器
- 本地DNS服务器
###DNS记录和报文


##P2P应用

##TCP套接字编程

##UDP套接字编程